<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/feed.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />
    <link
      href="https://cdn.boxicons.com/fonts/basic/boxicons.min.css"
      rel="stylesheet"
    />
    <title>Sonholândia | Feed</title>
  </head>
  <body>
    <header>
      <nav>
        <button>
          <div class="user">
            <!-- mostra foto e nome do usuário se tiver -->
            {% if user %}
            <img
              src="{{ user.picture }}"
              alt="avatar"
              width="32"
              style="border-radius: 50%; margin-right: 6px"
            />
            <p>{{ user.name }}</p>
            {% else %}
            <svg ...>...</svg>
            <p>User</p>
            {% endif %}
          </div>
        </button>

        <a href="{{ url_for('main.feed') }}" class="">Feed</a>
        <input type="search" placeholder="Pesquisar" />
        <a href="{{ url_for('dreams.post_dream') }}" class="linkPostarSonho">Postar um sonho</a>
        <button class="menuFeed">...</button>
        <a href="{{ url_for('auth.logout') }}" class="logout">Sair</a>
      </nav>
    </header>

    <main>
      <section>
        {% if dreams %}
          {% for dream in dreams %}
          <article class="reveal" id="sonho">
            <h2><a href="{{ url_for('dreams.view_dream', dream_id=dream.id) }}" class="dream-link">{{ dream.title }}</a></h2>
            <p>{{ dream.description[:200] }}{% if dream.description|length > 200 %}...{% endif %}</p>
            {% if dream.tags_list %}
            <article class="hashtags">
              {% for tag in dream.tags_list %}
              <a href="{{ url_for('main.feed') }}?tag={{ tag }}" class="tagsEngajamento">#{{ tag }}</a>
              {% endfor %}
            </article>
            {% endif %}
            <div class="dream-meta">
              <span class="dream-type-badge">{{ dream.dream_type|title }}</span>
              <span class="dream-author-name">{{ dream.name or dream.username }}</span>
            </div>
            <div class="buttonsDreams">
              <a href="{{ url_for('dreams.view_dream', dream_id=dream.id) }}" class="verMaisDentro">Ver mais</a>
            </div>
          </article>
          {% endfor %}
        {% else %}
          <article class="reveal" id="sonho">
            <h2>Nenhum sonho encontrado</h2>
            <p>Seja o primeiro a postar um sonho!</p>
            <div class="buttonsDreams">
              <a href="{{ url_for('dreams.post_dream') }}" class="verMaisDentro">Postar um sonho</a>
            </div>
          </article>
        {% endif %}
        {% if tag_filter %}
        <div class="filter-info">
          <p>Filtrando por: <strong>#{{ tag_filter }}</strong></p>
          <a href="{{ url_for('main.feed') }}" class="clear-filter">Limpar filtro</a>
        </div>
        {% endif %}
      </section>
    </main>

    <script src="{{ url_for('static', filename='js/feed.js') }}"></script>
  </body>
</html>
